#ifndef ROSE_RT_GAME_H
#define ROSE_RT_GAME_H

#include "config.h"
#include "cartridge.h"
#include "rt/rt_base.h"
#include "rt/lua_api.h"

typedef enum {
    ROSE_RT_GAME_FUN_NOT_FOUND,
    ROSE_RT_GAME_NO_ERR,
    ROSE_RT_GAME_CRITICAL_ERR
} Rose_RuntimeGameError;

typedef struct {
    Rose_Cartridge* cartridge;
    lua_State* lua;
    Rose_RuntimeBase* base;
} Rose_RuntimeGame;

typedef enum {
    ROSE_KEYCODE_A,
    ROSE_KEYCODE_B,
    ROSE_KEYCODE_C,
    ROSE_KEYCODE_D,
    ROSE_KEYCODE_E,
    ROSE_KEYCODE_F,
    ROSE_KEYCODE_G,
    ROSE_KEYCODE_H,
    ROSE_KEYCODE_I,
    ROSE_KEYCODE_J,
    ROSE_KEYCODE_K,
    ROSE_KEYCODE_L,
    ROSE_KEYCODE_M,
    ROSE_KEYCODE_N,
    ROSE_KEYCODE_O,
    ROSE_KEYCODE_P,
    ROSE_KEYCODE_Q,
    ROSE_KEYCODE_R,
    ROSE_KEYCODE_S,
    ROSE_KEYCODE_T,
    ROSE_KEYCODE_U,
    ROSE_KEYCODE_V,
    ROSE_KEYCODE_W,
    ROSE_KEYCODE_X,
    ROSE_KEYCODE_Y,
    ROSE_KEYCODE_Z,
    ROSE_KEYCODE_1,
    ROSE_KEYCODE_2,
    ROSE_KEYCODE_3,
    ROSE_KEYCODE_4,
    ROSE_KEYCODE_5,
    ROSE_KEYCODE_6,
    ROSE_KEYCODE_7,
    ROSE_KEYCODE_8,
    ROSE_KEYCODE_9,
    ROSE_KEYCODE_0,
    ROSE_KEYCODE_RETURN,
    ROSE_KEYCODE_ESCAPE,
    ROSE_KEYCODE_BACKSPACE,
    ROSE_KEYCODE_TAB,
    ROSE_KEYCODE_SPACE,
    ROSE_KEYCODE_MINUS,
    ROSE_KEYCODE_EQUALS,
    ROSE_KEYCODE_LEFTBRACKET,
    ROSE_KEYCODE_RIGHTBRACKET,
    ROSE_KEYCODE_BACKSLASH,
    ROSE_KEYCODE_NONUSHASH,
    ROSE_KEYCODE_SEMICOLON,
    ROSE_KEYCODE_APOSTROPHE,
    ROSE_KEYCODE_GRAVE,
    ROSE_KEYCODE_COMMA,
    ROSE_KEYCODE_PERIOD,
    ROSE_KEYCODE_SLASH,
    ROSE_KEYCODE_CAPSLOCK,
    ROSE_KEYCODE_F1,
    ROSE_KEYCODE_F2,
    ROSE_KEYCODE_F3,
    ROSE_KEYCODE_F4,
    ROSE_KEYCODE_F5,
    ROSE_KEYCODE_F6,
    ROSE_KEYCODE_F7,
    ROSE_KEYCODE_F8,
    ROSE_KEYCODE_F9,
    ROSE_KEYCODE_F10,
    ROSE_KEYCODE_F11,
    ROSE_KEYCODE_F12,
    ROSE_KEYCODE_PRINTSCREEN,
    ROSE_KEYCODE_SCROLLLOCK,
    ROSE_KEYCODE_PAUSE,
    ROSE_KEYCODE_INSERT,
    ROSE_KEYCODE_HOME,
    ROSE_KEYCODE_PAGEUP,
    ROSE_KEYCODE_DELETE,
    ROSE_KEYCODE_END,
    ROSE_KEYCODE_PAGEDOWN,
    ROSE_KEYCODE_RIGHT,
    ROSE_KEYCODE_LEFT,
    ROSE_KEYCODE_DOWN,
    ROSE_KEYCODE_UP,
    ROSE_KEYCODE_NUMLOCKCLEAR,
    ROSE_KEYCODE_KP_DIVIDE,
    ROSE_KEYCODE_KP_MULTIPLY,
    ROSE_KEYCODE_KP_MINUS,
    ROSE_KEYCODE_KP_PLUS,
    ROSE_KEYCODE_KP_ENTER,
    ROSE_KEYCODE_KP_1,
    ROSE_KEYCODE_KP_2,
    ROSE_KEYCODE_KP_3,
    ROSE_KEYCODE_KP_4,
    ROSE_KEYCODE_KP_5,
    ROSE_KEYCODE_KP_6,
    ROSE_KEYCODE_KP_7,
    ROSE_KEYCODE_KP_8,
    ROSE_KEYCODE_KP_9,
    ROSE_KEYCODE_KP_0,
    ROSE_KEYCODE_KP_PERIOD,
    ROSE_KEYCODE_NONUSBACKSLASH,
    ROSE_KEYCODE_APPLICATION,
    ROSE_KEYCODE_POWER,
    ROSE_KEYCODE_KP_EQUALS,
    ROSE_KEYCODE_F13,
    ROSE_KEYCODE_F14,
    ROSE_KEYCODE_F15,
    ROSE_KEYCODE_F16,
    ROSE_KEYCODE_F17,
    ROSE_KEYCODE_F18,
    ROSE_KEYCODE_F19,
    ROSE_KEYCODE_F20,
    ROSE_KEYCODE_F21,
    ROSE_KEYCODE_F22,
    ROSE_KEYCODE_F23,
    ROSE_KEYCODE_F24,
    ROSE_KEYCODE_EXECUTE,
    ROSE_KEYCODE_HELP,
    ROSE_KEYCODE_MENU,
    ROSE_KEYCODE_SELECT,
    ROSE_KEYCODE_STOP,
    ROSE_KEYCODE_AGAIN,
    ROSE_KEYCODE_UNDO,
    ROSE_KEYCODE_CUT,
    ROSE_KEYCODE_COPY,
    ROSE_KEYCODE_PASTE,
    ROSE_KEYCODE_FIND,
    ROSE_KEYCODE_MUTE,
    ROSE_KEYCODE_VOLUMEUP,
    ROSE_KEYCODE_VOLUMEDOWN,
    ROSE_KEYCODE_KP_COMMA,
    ROSE_KEYCODE_KP_EQUALSAS400,
    ROSE_KEYCODE_INTERNATIONAL1,
    ROSE_KEYCODE_INTERNATIONAL2,
    ROSE_KEYCODE_INTERNATIONAL3,
    ROSE_KEYCODE_INTERNATIONAL4,
    ROSE_KEYCODE_INTERNATIONAL5,
    ROSE_KEYCODE_INTERNATIONAL6,
    ROSE_KEYCODE_INTERNATIONAL7,
    ROSE_KEYCODE_INTERNATIONAL8,
    ROSE_KEYCODE_INTERNATIONAL9,
    ROSE_KEYCODE_LANG1,
    ROSE_KEYCODE_LANG2,
    ROSE_KEYCODE_LANG3,
    ROSE_KEYCODE_LANG4,
    ROSE_KEYCODE_LANG5,
    ROSE_KEYCODE_LANG6,
    ROSE_KEYCODE_LANG7,
    ROSE_KEYCODE_LANG8,
    ROSE_KEYCODE_LANG9,
    ROSE_KEYCODE_ALTERASE,
    ROSE_KEYCODE_SYSREQ,
    ROSE_KEYCODE_CANCEL,
    ROSE_KEYCODE_CLEAR,
    ROSE_KEYCODE_PRIOR,
    ROSE_KEYCODE_RETURN2,
    ROSE_KEYCODE_SEPARATOR,
    ROSE_KEYCODE_OUT,
    ROSE_KEYCODE_OPER,
    ROSE_KEYCODE_CLEARAGAIN,
    ROSE_KEYCODE_CRSEL,
    ROSE_KEYCODE_EXSEL,
    ROSE_KEYCODE_KP_00,
    ROSE_KEYCODE_KP_000,
    ROSE_KEYCODE_THOUSANDSSEPARATOR,
    ROSE_KEYCODE_DECIMALSEPARATOR,
    ROSE_KEYCODE_CURRENCYUNIT,
    ROSE_KEYCODE_CURRENCYSUBUNIT,
    ROSE_KEYCODE_KP_LEFTPAREN,
    ROSE_KEYCODE_KP_RIGHTPAREN,
    ROSE_KEYCODE_KP_LEFTBRACE,
    ROSE_KEYCODE_KP_RIGHTBRACE,
    ROSE_KEYCODE_KP_TAB,
    ROSE_KEYCODE_KP_BACKSPACE,
    ROSE_KEYCODE_KP_A,
    ROSE_KEYCODE_KP_B,
    ROSE_KEYCODE_KP_C,
    ROSE_KEYCODE_KP_D,
    ROSE_KEYCODE_KP_E,
    ROSE_KEYCODE_KP_F,
    ROSE_KEYCODE_KP_XOR,
    ROSE_KEYCODE_KP_POWER,
    ROSE_KEYCODE_KP_PERCENT,
    ROSE_KEYCODE_KP_LESS,
    ROSE_KEYCODE_KP_GREATER,
    ROSE_KEYCODE_KP_AMPERSAND,
    ROSE_KEYCODE_KP_DBLAMPERSAND,
    ROSE_KEYCODE_KP_VERTICALBAR,
    ROSE_KEYCODE_KP_DBLVERTICALBAR,
    ROSE_KEYCODE_KP_COLON,
    ROSE_KEYCODE_KP_HASH,
    ROSE_KEYCODE_KP_SPACE,
    ROSE_KEYCODE_KP_AT,
    ROSE_KEYCODE_KP_EXCLAM,
    ROSE_KEYCODE_KP_MEMSTORE,
    ROSE_KEYCODE_KP_MEMRECALL,
    ROSE_KEYCODE_KP_MEMCLEAR,
    ROSE_KEYCODE_KP_MEMADD,
    ROSE_KEYCODE_KP_MEMSUBTRACT,
    ROSE_KEYCODE_KP_MEMMULTIPLY,
    ROSE_KEYCODE_KP_MEMDIVIDE,
    ROSE_KEYCODE_KP_PLUSMINUS,
    ROSE_KEYCODE_KP_CLEAR,
    ROSE_KEYCODE_KP_CLEARENTRY,
    ROSE_KEYCODE_KP_BINARY,
    ROSE_KEYCODE_KP_OCTAL,
    ROSE_KEYCODE_KP_DECIMAL,
    ROSE_KEYCODE_KP_HEXADECIMAL,
    ROSE_KEYCODE_LCTRL,
    ROSE_KEYCODE_LSHIFT,
    ROSE_KEYCODE_LALT,
    ROSE_KEYCODE_LGUI,
    ROSE_KEYCODE_RCTRL,
    ROSE_KEYCODE_RSHIFT,
    ROSE_KEYCODE_RALT,
    ROSE_KEYCODE_RGUI,
    ROSE_KEYCODE_MODE,
    ROSE_KEYCODE_AUDIONEXT,
    ROSE_KEYCODE_AUDIOPREV,
    ROSE_KEYCODE_AUDIOSTOP,
    ROSE_KEYCODE_AUDIOPLAY,
    ROSE_KEYCODE_AUDIOMUTE,
    ROSE_KEYCODE_MEDIASELECT,
    ROSE_KEYCODE_WWW,
    ROSE_KEYCODE_MAIL,
    ROSE_KEYCODE_CALCULATOR,
    ROSE_KEYCODE_COMPUTER,
    ROSE_KEYCODE_AC_SEARCH,
    ROSE_KEYCODE_AC_HOME,
    ROSE_KEYCODE_AC_BACK,
    ROSE_KEYCODE_AC_FORWARD,
    ROSE_KEYCODE_AC_STOP,
    ROSE_KEYCODE_AC_REFRESH,
    ROSE_KEYCODE_AC_BOOKMARKS,
    ROSE_KEYCODE_BRIGHTNESSDOWN,
    ROSE_KEYCODE_BRIGHTNESSUP,
    ROSE_KEYCODE_DISPLAYSWITCH,
    ROSE_KEYCODE_KBDILLUMTOGGLE,
    ROSE_KEYCODE_KBDILLUMDOWN,
    ROSE_KEYCODE_KBDILLUMUP,
    ROSE_KEYCODE_EJECT,
    ROSE_KEYCODE_SLEEP,
    ROSE_KEYCODE_APP1,
    ROSE_KEYCODE_APP2,
    ROSE_KEYCODE_UNKNOWN
} Rose_KeyCode;

Rose_RuntimeGame* rose_runtime_game_create(Rose_Cartridge* cartridge);

void rose_runtime_game_free(Rose_RuntimeGame* r);

bool rose_runtime_game_reload(Rose_RuntimeGame* r);

Rose_RuntimeGameError rose_runtime_game_init(Rose_RuntimeGame* r);

Rose_RuntimeGameError rose_runtime_game_update(Rose_RuntimeGame* r);

Rose_RuntimeGameError rose_runtime_game_draw(Rose_RuntimeGame* r);

Rose_RuntimeGameError rose_runtime_game_onmouse(Rose_RuntimeGame* r, int16_t x, int16_t y);

Rose_RuntimeGameError rose_runtime_game_onwheel(Rose_RuntimeGame* r, int16_t x, int16_t y, bool inverted);

Rose_RuntimeGameError rose_runtime_game_onbtn(Rose_RuntimeGame* r, uint8_t code, bool pressed);

Rose_RuntimeGameError rose_runtime_game_onkey(Rose_RuntimeGame* r, Rose_KeyCode keycode, bool pressed, bool repeat);

Rose_RuntimeGameError rose_runtime_game_ontouch(Rose_RuntimeGame* r);

#endif
